import{u as p}from"./index-o7np2shc.js";import{j as m,Y as b,u as x,d as O}from"./Stacks-0gbGCfo_.js";import{r as n,R as P}from"./index-4g5l5LRQ.js";import{r as S}from"./EventEmitter-8bYFdwfg.js";const V=n.memo(({host:e=(t=>(t=globalThis.document)==null?void 0:t.body)(),...r})=>{const a=m.jsx(b,{contain:"strict",fullscreen:!0,position:"fixed",maxWidth:"100vw",maxHeight:"100vh",pointerEvents:"none",...r}),[o,l]=n.useState(null);return x(()=>{l(e)},[e]),o&&r.children?S.createPortal(a,o):null}),U={},v=(e,r)=>(r in e||(e[r]=[]),e),w=(e,r)=>(delete e[r],e),I=(e,r,t,a)=>{r in e||(e=v(e,r));const o=e[r].findIndex(l=>l.name===t);return o!==-1?e[r][o].node=a:e[r].push({name:t,node:a}),e},j=(e,r,t)=>{if(!(r in e))return console.info(`Failed to remove portal '${t}', '${r}' was not registered!`),e;const a=e[r].findIndex(o=>o.name===t);return a!==-1&&e[r].splice(a,1),e},k=(e,r)=>{const{type:t}=r;switch(t){case 0:return v({...e},r.hostName);case 1:return w({...e},r.hostName);case 2:return I({...e},r.hostName,r.portalName,r.node);case 3:return j({...e},r.hostName,r.portalName);default:return e}},f=n.createContext(null),h=n.createContext(null),R=e=>{const r=n.useContext(f);if(r===null)throw new Error("'PortalStateContext' cannot be null, please add 'PortalProvider' to the root component.");return r[e]||[]},H=(e="root")=>{const r=n.useContext(h);if(r===null)throw new Error("'PortalDispatchContext' cannot be null, please add 'PortalProvider' to the root component.");const t=n.useCallback(()=>{r({type:0,hostName:e})},[]),a=n.useCallback(()=>{r({type:1,hostName:e})},[]),o=n.useCallback((s,i)=>{r({type:2,hostName:e,portalName:s,node:i})},[]),l=n.useCallback(s=>{r({type:3,hostName:e,portalName:s})},[]);return{registerHost:t,deregisterHost:a,addPortal:o,updatePortal:o,removePortal:l}},D=({rootHostName:e="root",shouldAddRootHost:r=!0,children:t})=>{const[a,o]=n.useReducer(k,U),l=n.useMemo(()=>s=>{n.startTransition(()=>{o(s)})},[o]);return m.jsx(h.Provider,{value:l,children:m.jsxs(f.Provider,{value:a,children:[t,r&&m.jsx(C,{name:e})]})})},T=n.memo(D);T.displayName="PortalProvider";const _=e=>m.jsx(m.Fragment,{children:e}),M=e=>{const{name:r,forwardProps:t,render:a=_}=e,o=!O(),l=R(r),{registerHost:s,deregisterHost:i}=H(e.name);return n.useEffect(()=>{if(!o)return s(),()=>{i()}},[o]),a(t?l.map(u=>{let c=u.node;return t?P.Children.map(c,d=>P.isValidElement(d)?P.cloneElement(d,{key:d.key,...t}):d):c}):l.map(u=>u.node))},C=n.memo(M);C.displayName="PortalHost";const F=e=>{const{name:r,hostName:t,handleOnMount:a,handleOnUnmount:o,handleOnUpdate:l,children:s}=e,{addPortal:i,removePortal:u}=H(t),c=n.useId(),d=r||c,E=p(()=>{a?a(()=>i(d,s)):i(d,s)}),g=p(()=>{o?o(()=>u(d)):u(d)}),y=p(()=>{l?l(()=>i(d,s)):i(d,s)});return x(()=>(E(),()=>{g()}),[]),n.useEffect(()=>{y()},[s]),null},A=n.memo(F);A.displayName="Portal";export{V as P,A as a,C as b,T as c};
