import{r as a,R as u}from"./index-4g5l5LRQ.js";import{j as v,m as B,Y as se,l as ae}from"./Stacks-cf55noxu.js";import{r as ie,_ as P}from"./extends-nGe_wfaW.js";import{U as A,a as Z,V as K,u as ce,s as X,i as M,D as de,m as ue,_ as f,d as he,E as pe}from"./EventEmitter-3h9cKSNS.js";import{g as me}from"./_commonjsHelpers-4gQjN7DL.js";typeof globalThis.__DEV__>"u"&&(globalThis.__DEV__=!1);const Se=a.createContext(null),Je=r=>v.jsx(Se.Provider,{value:null,children:r.children});function fe(r,e,t){const o=a.useRef(e??r);return B(()=>{o.current=r}),a.useCallback(t?(...n)=>{var l;return(l=o.current)==null?void 0:l.apply(null,n)}:()=>o.current,[])}function q(r){return fe(r,ve,!0)}const ve=()=>{throw new Error("Cannot call an event handler while rendering.")},er=a.memo(({host:r=(t=>(t=globalThis.document)==null?void 0:t.body)(),...e})=>{const o=v.jsx(se,{contain:"strict",fullscreen:!0,position:"fixed",maxWidth:"100vw",maxHeight:"100vh",pointerEvents:"none",...e}),[n,l]=a.useState(null);return B(()=>{l(r)},[r]),n&&e.children?ie.createPortal(o,n):null}),ge={},J=(r,e)=>(e in r||(r[e]=[]),r),Re=(r,e)=>(delete r[e],r),Te=(r,e,t,o)=>{e in r||(r=J(r,e));const n=r[e].findIndex(l=>l.name===t);return n!==-1?r[e][n].node=o:r[e].push({name:t,node:o}),r},ye=(r,e,t)=>{if(!(e in r))return console.info(`Failed to remove portal '${t}', '${e}' was not registered!`),r;const o=r[e].findIndex(n=>n.name===t);return o!==-1&&r[e].splice(o,1),r},be=(r,e)=>{const{type:t}=e;switch(t){case 0:return J({...r},e.hostName);case 1:return Re({...r},e.hostName);case 2:return Te({...r},e.hostName,e.portalName,e.node);case 3:return ye({...r},e.hostName,e.portalName);default:return r}},ee=a.createContext(null),re=a.createContext(null),we=r=>{const e=a.useContext(ee);if(e===null)throw new Error("'PortalStateContext' cannot be null, please add 'PortalProvider' to the root component.");return e[r]||[]},te=(r="root")=>{const e=a.useContext(re);if(e===null)throw new Error("'PortalDispatchContext' cannot be null, please add 'PortalProvider' to the root component.");const t=a.useCallback(()=>{e({type:0,hostName:r})},[]),o=a.useCallback(()=>{e({type:1,hostName:r})},[]),n=a.useCallback((s,i)=>{e({type:2,hostName:r,portalName:s,node:i})},[]),l=a.useCallback(s=>{e({type:3,hostName:r,portalName:s})},[]);return{registerHost:t,deregisterHost:o,addPortal:n,updatePortal:n,removePortal:l}},Ee=({rootHostName:r="root",shouldAddRootHost:e=!0,children:t})=>{const[o,n]=a.useReducer(be,ge),l=a.useMemo(()=>s=>{a.startTransition(()=>{n(s)})},[n]);return v.jsx(re.Provider,{value:l,children:v.jsxs(ee.Provider,{value:o,children:[t,e&&v.jsx(oe,{name:r})]})})},He=a.memo(Ee);He.displayName="PortalProvider";const _e=r=>v.jsx(v.Fragment,{children:r}),Ce=r=>{const{name:e,forwardProps:t,render:o=_e}=r,n=!ae(),l=we(e),{registerHost:s,deregisterHost:i}=te(r.name);return a.useEffect(()=>{if(!n)return s(),()=>{i()}},[n]),o(t?l.map(h=>{let m=h.node;return t?u.Children.map(m,c=>u.isValidElement(c)?u.cloneElement(c,{key:c.key,...t}):c):m}):l.map(h=>h.node))},oe=a.memo(Ce);oe.displayName="PortalHost";const ke=r=>{const{name:e,hostName:t,handleOnMount:o,handleOnUnmount:n,handleOnUpdate:l,children:s}=r,{addPortal:i,removePortal:h}=te(t),m=a.useId(),c=e||m,R=q(()=>{o?o(()=>i(c,s)):i(c,s)}),y=q(()=>{n?n(()=>h(c)):h(c)}),p=q(()=>{l?l(()=>i(c,s)):i(c,s)});return B(()=>(R(),()=>{y()}),[]),a.useEffect(()=>{p()},[s]),null},Ie=a.memo(ke);Ie.displayName="Portal";var D={_currentlyFocusedNode:null,currentlyFocusedField(){return document.activeElement!==this._currentlyFocusedNode&&(this._currentlyFocusedNode=null),this._currentlyFocusedNode},focusTextInput(r){r!==null&&(this._currentlyFocusedNode=r,document.activeElement!==r&&A.focus(r))},blurTextInput(r){r!==null&&(this._currentlyFocusedNode=null,document.activeElement===r&&A.blur(r))}},xe=()=>{D.blurTextInput(D.currentlyFocusedField())},Pe=["onScroll","onTouchMove","onWheel","scrollEnabled","scrollEventThrottle","showsHorizontalScrollIndicator","showsVerticalScrollIndicator","style"];function U(r){return{nativeEvent:{contentOffset:{get x(){return r.target.scrollLeft},get y(){return r.target.scrollTop}},contentSize:{get height(){return r.target.scrollHeight},get width(){return r.target.scrollWidth}},layoutMeasurement:{get height(){return r.target.offsetHeight},get width(){return r.target.offsetWidth}}},timeStamp:Date.now()}}function Me(r,e){var t=Date.now()-r;return e>0&&t>=e}var De=a.forwardRef((r,e)=>{var t=r.onScroll,o=r.onTouchMove,n=r.onWheel,l=r.scrollEnabled,s=l===void 0?!0:l,i=r.scrollEventThrottle,h=i===void 0?0:i,m=r.showsHorizontalScrollIndicator,c=r.showsVerticalScrollIndicator,R=r.style,y=Z(r,Pe),p=a.useRef({isScrolling:!1,scrollLastTick:0}),b=a.useRef(null),H=a.useRef(null);function w(d){return le=>{s&&d&&d(le)}}function _(d){d.stopPropagation(),d.target===H.current&&(d.persist(),b.current!=null&&clearTimeout(b.current),b.current=setTimeout(()=>{F(d)},100),p.current.isScrolling?Me(p.current.scrollLastTick,h)&&T(d):C(d))}function C(d){p.current.isScrolling=!0,T(d)}function T(d){p.current.scrollLastTick=Date.now(),t&&t(U(d))}function F(d){p.current.isScrolling=!1,t&&t(U(d))}var k=m===!1||c===!1;return a.createElement(K,P({},y,{onScroll:_,onTouchMove:w(o),onWheel:w(n),ref:ce(H,e),style:[R,!s&&L.scrollDisabled,k&&L.hideScrollbar]}))}),L=X.create({scrollDisabled:{overflowX:"hidden",overflowY:"hidden",touchAction:"none"},hideScrollbar:{scrollbarWidth:"none"}});function z(r){return function(){return r}}var g=function(){};g.thatReturns=z;g.thatReturnsFalse=z(!1);g.thatReturnsTrue=z(!0);g.thatReturnsNull=z(null);g.thatReturnsThis=function(){return this};g.thatReturnsArgument=function(r){return r};var Ne=g,Ve=Ne,Oe=Ve,We=Oe;const ze=me(We);var Fe=["contentContainerStyle","horizontal","onContentSizeChange","refreshControl","stickyHeaderIndices","pagingEnabled","forwardedRef","keyboardDismissMode","onScroll","centerContent"],$={},qe=16;class Ae extends u.Component{constructor(){super(...arguments),this._scrollNodeRef=null,this._innerViewRef=null,this.isTouching=!1,this.lastMomentumScrollBeginTime=0,this.lastMomentumScrollEndTime=0,this.observedScrollSinceBecomingResponder=!1,this.becameResponderWhileAnimating=!1,this.scrollResponderHandleScrollShouldSetResponder=()=>this.isTouching,this.scrollResponderHandleStartShouldSetResponderCapture=e=>this.scrollResponderIsAnimating(),this.scrollResponderHandleTerminationRequest=()=>!this.observedScrollSinceBecomingResponder,this.scrollResponderHandleTouchEnd=e=>{var t=e.nativeEvent;this.isTouching=t.touches.length!==0,this.props.onTouchEnd&&this.props.onTouchEnd(e)},this.scrollResponderHandleResponderRelease=e=>{this.props.onResponderRelease&&this.props.onResponderRelease(e);var t=D.currentlyFocusedField();!this.props.keyboardShouldPersistTaps&&t!=null&&e.target!==t&&!this.observedScrollSinceBecomingResponder&&!this.becameResponderWhileAnimating&&(this.props.onScrollResponderKeyboardDismissed&&this.props.onScrollResponderKeyboardDismissed(e),D.blurTextInput(t))},this.scrollResponderHandleScroll=e=>{this.observedScrollSinceBecomingResponder=!0,this.props.onScroll&&this.props.onScroll(e)},this.scrollResponderHandleResponderGrant=e=>{this.observedScrollSinceBecomingResponder=!1,this.props.onResponderGrant&&this.props.onResponderGrant(e),this.becameResponderWhileAnimating=this.scrollResponderIsAnimating()},this.scrollResponderHandleScrollBeginDrag=e=>{this.props.onScrollBeginDrag&&this.props.onScrollBeginDrag(e)},this.scrollResponderHandleScrollEndDrag=e=>{this.props.onScrollEndDrag&&this.props.onScrollEndDrag(e)},this.scrollResponderHandleMomentumScrollBegin=e=>{this.lastMomentumScrollBeginTime=Date.now(),this.props.onMomentumScrollBegin&&this.props.onMomentumScrollBegin(e)},this.scrollResponderHandleMomentumScrollEnd=e=>{this.lastMomentumScrollEndTime=Date.now(),this.props.onMomentumScrollEnd&&this.props.onMomentumScrollEnd(e)},this.scrollResponderHandleTouchStart=e=>{this.isTouching=!0,this.props.onTouchStart&&this.props.onTouchStart(e)},this.scrollResponderHandleTouchMove=e=>{this.props.onTouchMove&&this.props.onTouchMove(e)},this.scrollResponderIsAnimating=()=>{var e=Date.now(),t=e-this.lastMomentumScrollEndTime,o=t<qe||this.lastMomentumScrollEndTime<this.lastMomentumScrollBeginTime;return o},this.scrollResponderScrollTo=(e,t,o)=>{if(typeof e=="number")console.warn("`scrollResponderScrollTo(x, y, animated)` is deprecated. Use `scrollResponderScrollTo({x: 5, y: 5, animated: true})` instead.");else{var n=e||$;e=n.x,t=n.y,o=n.animated}var l=this.getScrollableNode(),s=e||0,i=t||0;l!=null&&(typeof l.scroll=="function"?l.scroll({top:i,left:s,behavior:o?"smooth":"auto"}):(l.scrollLeft=s,l.scrollTop=i))},this.scrollResponderZoomTo=(e,t)=>{M("zoomToRect is not implemented")},this.scrollResponderScrollNativeHandleToKeyboard=(e,t,o)=>{this.additionalScrollOffset=t||0,this.preventNegativeScrollOffset=!!o,A.measureLayout(e,this.getInnerViewNode(),this.scrollResponderTextInputFocusError,this.scrollResponderInputMeasureAndScrollToKeyboard)},this.scrollResponderInputMeasureAndScrollToKeyboard=(e,t,o,n)=>{var l=de.get("window").height;this.keyboardWillOpenTo&&(l=this.keyboardWillOpenTo.endCoordinates.screenY);var s=t-l+n+this.additionalScrollOffset;this.preventNegativeScrollOffset&&(s=Math.max(0,s)),this.scrollResponderScrollTo({x:0,y:s,animated:!0}),this.additionalOffset=0,this.preventNegativeScrollOffset=!1},this.scrollResponderKeyboardWillShow=e=>{this.keyboardWillOpenTo=e,this.props.onKeyboardWillShow&&this.props.onKeyboardWillShow(e)},this.scrollResponderKeyboardWillHide=e=>{this.keyboardWillOpenTo=null,this.props.onKeyboardWillHide&&this.props.onKeyboardWillHide(e)},this.scrollResponderKeyboardDidShow=e=>{e&&(this.keyboardWillOpenTo=e),this.props.onKeyboardDidShow&&this.props.onKeyboardDidShow(e)},this.scrollResponderKeyboardDidHide=e=>{this.keyboardWillOpenTo=null,this.props.onKeyboardDidHide&&this.props.onKeyboardDidHide(e)},this.flashScrollIndicators=()=>{this.scrollResponderFlashScrollIndicators()},this.getScrollResponder=()=>this,this.getScrollableNode=()=>this._scrollNodeRef,this.getInnerViewRef=()=>this._innerViewRef,this.getInnerViewNode=()=>this._innerViewRef,this.getNativeScrollRef=()=>this._scrollNodeRef,this.scrollTo=(e,t,o)=>{if(typeof e=="number")console.warn("`scrollTo(y, x, animated)` is deprecated. Use `scrollTo({x: 5, y: 5, animated: true})` instead.");else{var n=e||$;t=n.x,e=n.y,o=n.animated}this.scrollResponderScrollTo({x:t||0,y:e||0,animated:o!==!1})},this.scrollToEnd=e=>{var t=(e&&e.animated)!==!1,o=this.props.horizontal,n=this.getScrollableNode(),l=o?n.scrollWidth:0,s=o?0:n.scrollHeight;this.scrollResponderScrollTo({x:l,y:s,animated:t})},this._handleContentOnLayout=e=>{var t=e.nativeEvent.layout,o=t.width,n=t.height;this.props.onContentSizeChange(o,n)},this._handleScroll=e=>{this.props.keyboardDismissMode==="on-drag"&&xe(),this.scrollResponderHandleScroll(e)},this._setInnerViewRef=e=>{this._innerViewRef=e},this._setScrollNodeRef=e=>{this._scrollNodeRef=e,e!=null&&(e.getScrollResponder=this.getScrollResponder,e.getInnerViewNode=this.getInnerViewNode,e.getInnerViewRef=this.getInnerViewRef,e.getNativeScrollRef=this.getNativeScrollRef,e.getScrollableNode=this.getScrollableNode,e.scrollTo=this.scrollTo,e.scrollToEnd=this.scrollToEnd,e.flashScrollIndicators=this.flashScrollIndicators,e.scrollResponderZoomTo=this.scrollResponderZoomTo,e.scrollResponderScrollNativeHandleToKeyboard=this.scrollResponderScrollNativeHandleToKeyboard);var t=ue(this.props.forwardedRef);t(e)}}scrollResponderHandleStartShouldSetResponder(){return!1}scrollResponderHandleResponderReject(){ze(!1,"ScrollView doesn't take rejection well - scrolls anyway")}scrollResponderFlashScrollIndicators(){}scrollResponderTextInputFocusError(e){console.error("Error measuring text field: ",e)}render(){var e=this.props,t=e.contentContainerStyle,o=e.horizontal,n=e.onContentSizeChange,l=e.refreshControl,s=e.stickyHeaderIndices,i=e.pagingEnabled;e.forwardedRef,e.keyboardDismissMode,e.onScroll;var h=e.centerContent,m=Z(e,Fe),c={};n&&(c={onLayout:this._handleContentOnLayout});var R=!o&&Array.isArray(s),y=R||i?u.Children.map(this.props.children,(T,F)=>{var k=R&&s.indexOf(F)>-1;return T!=null&&(k||i)?u.createElement(K,{style:[k&&S.stickyHeader,i&&S.pagingEnabledChild]},T):T}):this.props.children,p=u.createElement(K,P({},c,{children:y,collapsable:!1,ref:this._setInnerViewRef,style:[o&&S.contentContainerHorizontal,h&&S.contentContainerCenterContent,t]})),b=o?S.baseHorizontal:S.baseVertical,H=o?S.pagingEnabledHorizontal:S.pagingEnabledVertical,w=f(f({},m),{},{style:[b,i&&H,this.props.style],onTouchStart:this.scrollResponderHandleTouchStart,onTouchMove:this.scrollResponderHandleTouchMove,onTouchEnd:this.scrollResponderHandleTouchEnd,onScrollBeginDrag:this.scrollResponderHandleScrollBeginDrag,onScrollEndDrag:this.scrollResponderHandleScrollEndDrag,onMomentumScrollBegin:this.scrollResponderHandleMomentumScrollBegin,onMomentumScrollEnd:this.scrollResponderHandleMomentumScrollEnd,onStartShouldSetResponder:this.scrollResponderHandleStartShouldSetResponder,onStartShouldSetResponderCapture:this.scrollResponderHandleStartShouldSetResponderCapture,onScrollShouldSetResponder:this.scrollResponderHandleScrollShouldSetResponder,onScroll:this._handleScroll,onResponderGrant:this.scrollResponderHandleResponderGrant,onResponderTerminationRequest:this.scrollResponderHandleTerminationRequest,onResponderTerminate:this.scrollResponderHandleTerminate,onResponderRelease:this.scrollResponderHandleResponderRelease,onResponderReject:this.scrollResponderHandleResponderReject}),_=De;M(_!==void 0,"ScrollViewClass must not be undefined");var C=u.createElement(_,P({},w,{ref:this._setScrollNodeRef}),p);return l?u.cloneElement(l,{style:w.style},C):C}}var Q={flexGrow:1,flexShrink:1,transform:"translateZ(0)",WebkitOverflowScrolling:"touch"},S=X.create({baseVertical:f(f({},Q),{},{flexDirection:"column",overflowX:"hidden",overflowY:"auto"}),baseHorizontal:f(f({},Q),{},{flexDirection:"row",overflowX:"auto",overflowY:"hidden"}),contentContainerHorizontal:{flexDirection:"row"},contentContainerCenterContent:{justifyContent:"center",flexGrow:1},stickyHeader:{position:"sticky",top:0,zIndex:10},pagingEnabledHorizontal:{scrollSnapType:"x mandatory"},pagingEnabledVertical:{scrollSnapType:"y mandatory"},pagingEnabledChild:{scrollSnapAlign:"start"}}),ne=u.forwardRef((r,e)=>u.createElement(Ae,P({},r,{forwardedRef:e})));ne.displayName="ScrollView";const rr=ne;class Ke{constructor(e){var t=e.onMoreTasks;this._onMoreTasks=t,this._queueStack=[{tasks:[],popable:!0}]}enqueue(e){this._getCurrentQueue().push(e)}enqueueTasks(e){e.forEach(t=>this.enqueue(t))}cancelTasks(e){this._queueStack=this._queueStack.map(t=>f(f({},t),{},{tasks:t.tasks.filter(o=>e.indexOf(o)===-1)})).filter((t,o)=>t.tasks.length>0||o===0)}hasTasksToProcess(){return this._getCurrentQueue().length>0}processNext(){var e=this._getCurrentQueue();if(e.length){var t=e.shift();try{typeof t=="object"&&t.gen?this._genPromise(t):typeof t=="object"&&t.run?t.run():(M(typeof t=="function",`Expected Function, SimpleTask, or PromiseTask, but got:
`+JSON.stringify(t,null,2)),t())}catch(o){throw o.message="TaskQueue: Error with task "+(t.name||"")+": "+o.message,o}}}_getCurrentQueue(){var e=this._queueStack.length-1,t=this._queueStack[e];return t.popable&&t.tasks.length===0&&e>0?(this._queueStack.pop(),this._getCurrentQueue()):t.tasks}_genPromise(e){var t=this._queueStack.push({tasks:[],popable:!1}),o=t-1,n=this._queueStack[o];e.gen().then(()=>{n.popable=!0,this.hasTasksToProcess()&&this._onMoreTasks()}).catch(l=>{setTimeout(()=>{throw l.message="TaskQueue: Error resolving Promise in task "+e.name+": "+l.message,l},0)})}}const je=Ke;var Be=function(e,t){return setTimeout(()=>{var o=Date.now();e({didTimeout:!1,timeRemaining(){return Math.max(0,50-(Date.now()-o))}})},1)},Ue=he&&typeof window.requestIdleCallback<"u",Le=Ue?window.requestIdleCallback:Be,N=new pe,G={Events:{interactionStart:"interactionStart",interactionComplete:"interactionComplete"},runAfterInteractions(r){var e=[],t=new Promise(o=>{E(),r&&e.push(r),e.push({run:o,name:"resolve "+(r&&r.name||"?")}),O.enqueueTasks(e)});return{then:t.then.bind(t),done:t.then.bind(t),cancel:()=>{O.cancelTasks(e)}}},createInteractionHandle(){E();var r=++$e;return V.add(r),r},clearInteractionHandle(r){M(!!r,"Must provide a handle to clear."),E(),V.delete(r),j.add(r)},addListener:N.addListener.bind(N),setDeadline(r){W=r}},I=new Set,V=new Set,j=new Set,O=new je({onMoreTasks:E}),x=0,$e=0,W=-1;function E(){x||(W>0?x=setTimeout(Y):x=Le(Y))}function Y(){x=0;var r=I.size;V.forEach(o=>I.add(o)),j.forEach(o=>I.delete(o));var e=I.size;if(r!==0&&e===0?N.emit(G.Events.interactionComplete):r===0&&e!==0&&N.emit(G.Events.interactionStart),e===0){for(var t=Date.now();O.hasTasksToProcess();)if(O.processNext(),W>0&&Date.now()-t>=W){E();break}}V.clear(),j.clear()}export{G as I,er as P,Je as R,rr as S,D as T,Ie as a,oe as b,fe as c,Se as d,He as e,q as u};
